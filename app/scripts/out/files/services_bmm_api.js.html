<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>services/bmm_api.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/bmmDebug.html">bmmDebug</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: services/bmm_api.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x27;use strict&#x27;;

angular.module(&#x27;bmmLibApp&#x27;)
  .factory(&#x27;bmmApi&#x27;, [function () {
  
  var factory = {},
      serverUrl = &#x27;localhost/&#x27;;

  /** Set custom serverUrl **/
  factory.serverUrl = function(url) {
    serverUrl = url;
  };

  /** Get the basic information about the API **/
  factory.root = function() {
    
    /** RETURNS
     *    name                      String
     *    documentation             Url
     *    system_status             Object
     *      database                Boolean
     *      search                  Boolean
     *    languages                 Array(String)
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      crossDomain: true,
      url: serverUrl,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Save a new album **/
  factory.album = function(options) {
    
    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    parent_id *               Integer         Can also be NULL
     *    started_at *              datetime        ISO 8601
     *    ended_at *                datetime        ISO 8601
     *    original_language *       String          ISO 639-1 || ISO 639-3
     *    translations [{           Array(objects)
     *      language: &#x27;&#x27;,           string          ISO 639-1 || ISO 639-3
     *      title: &#x27;&#x27;               String
     *    }]
     *    cover *                   String
     *    show_in_listing *         Boolean
     *    show_in_library *         Boolean
     *    type                      String          Always &#x27;album&#x27;
     *    description               String
     */

    return $.ajax({
      method: &#x27;POST&#x27;,
      url: serverUrl+&#x27;album&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get the latest albums of a specific type (Default is all types) **/
  factory.albumLatest = function(options) {
    
    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    size                      Integer         \d+
     *    from                      Integer         \d+
     *    content-type              Array(string)   song|speech|audiobook|singsong|video
     *    media-type                Array(string)   audio|video
     *    unpublished               string          hide|show|only
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;album/latest&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a translated version of an album **/
  factory.albumGet = function(id, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    raw                       Boolean         Role: ROLE_ALBUM_MANAGER
     */

    /** RETURNS
     *    id                        Integer
     *    parent_id                 Integer
     *    type                      String
     *    description               String
     *    created_at                datetime        ISO 8601
     *    ended_at                  datetime        ISO 8601
     *    started_at                datetime        ISO 8601
     *    original_languages        String          ISO 639-1 || ISO 639-3
     *    translations [{           Array(objects)
     *      language: &#x27;&#x27;,           string          ISO 639-1 || ISO 639-3
     *      title: &#x27;&#x27;               String
     *    }]
     *    show_in_listing *         Boolean
     *    show_in_library *         Boolean
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;album/&#x27;+id,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Save an album **/
  factory.albumPut = function(id, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    parent_id *               Integer         Can also be NULL
     *    started_at *              datetime        ISO 8601
     *    ended_at *                datetime        ISO 8601
     *    original_language *       String          ISO 639-1 || ISO 639-3
     *    translations [{           Array(objects)
     *      language: &#x27;&#x27;,           string          ISO 639-1 || ISO 639-3
     *      title: &#x27;&#x27;               String
     *    }]
     *    cover *                   String
     *    show_in_listing *         Boolean
     *    show_in_library *         Boolean
     *    type                      String          Always &#x27;album&#x27;
     *    description               String
     */

    return $.ajax({
      method: &#x27;PUT&#x27;,
      url: serverUrl+&#x27;album/&#x27;+id,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Delete an album **/
  factory.albumDelete = function(id) {

    return $.ajax({
      method: &#x27;DELETE&#x27;,
      url: serverUrl+&#x27;album/&#x27;+id,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a list of years for the archive **/
  factory.facetsPublishedYears = function(options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    content-type              Array(String)   song|speech|audiobook|singsong|video
     *    media-type                Array(String)   audio|video
     *    unpublished               String          hide|show|only
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;facets/published/years&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Authenticate by username and password **/
  factory.loginAuthentication = function(options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    username *                String
     *    password *                String
     */

    return $.ajax({
      method: &#x27;POST&#x27;,
      url: serverUrl+&#x27;login/authentication&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Authenticates the user by redirecting him to the Sherwood SignOn Server **/
  factory.loginRedirect = function() {

    window.location = serverUrl+&#x27;login/redirect?redirect_to=&#x27;+window.location;

  };

  /** Get a list of the data **/
  factory.search = function(term, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    size                      Integer         \d+ Def = 20
     *    from                      Integer         \d+ Def = 0
     *    resource-type             Array(String)   album|track
     *    media-type                Array(String)   audio|video
     *    content-type              Array(String)   song|speech|audiobook|singsong|video
     *    unpublished               String          hide|show|only Role: ROLE_CONTENT_UNPUBLISHED
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;search/&#x27;+term,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a list of suggestions based on a given term **/
  factory.suggest = function(term) {

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;suggest/&#x27;+term,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Save a new track **/
  factory.track = function(options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    parent_id *               Integer
     *    listing_parent *          Integer
     *    order *                   Integer
     *    type                      String
     *    description               String
     *    subtype *                 String          speech|audiobook|singsong|video
     *    tags *                    Array(String)
     *    published_at *            datetime        ISO 8601
     *    original_language *       String          ISO 639-1 || ISO 639-3 zxx
     *    translations [{ *         Array(objects)
     *      language: &#x27;&#x27;, *         String          ISO 639-1 || ISO 639-3 zxx
     *      title: &#x27;&#x27;, *            String
     *      rel [{ *                Array(objects)
     *        type: &#x27;&#x27;, *           String          bible|composer|lyrics|interpret|songbook
     *        id: int, *            Integer         type: songbook
     *        name: &#x27;&#x27;,             String          type: composer|lyrics|interpret|songbook
     *        timestamp: int, *     Integer         type: bible|songbook
     *        book: &#x27;&#x27;,             String          type: bible
     *        chapter: int, *       Integer         type: bible
     *        verse: int, *         Integer         type: bible
     *      }],
     *      media [{ *              Array(Objects)
     *        type: &#x27;&#x27;,             String          audio|video
     *        files: [{ *
     *          mime_type: &#x27;&#x27;, *    String
     *          length: int, *      Integer
     *          size: int, *        Integer
     *          path: &#x27;&#x27; *          String
     *        }],
     *      }],
     *    }]
     *    rel[{
     *      type: &#x27;&#x27;, *             String
     *      id: int, *              Integer         type: songbook
     *      name: &#x27;&#x27;,               String          type: composer|lyrics|interpret|songbook
     *      timestamp: int, *       Integer         type: bible|songbook
     *      book: &#x27;&#x27;,               String          type: bible
     *      chapter: int, *         Integer         type: bible
     *      verse: int, *           Integer         type: bible
     *    }]
     */

    return $.ajax({
      method: &#x27;POST&#x27;,
      url: serverUrl+&#x27;track&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a list of the latest tracks in the library **/
  factory.trackLatest = function(options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    size                      Integer         \d+ Def = 20
     *    from                      Integer         \d+ Def = 0
     *    content-type              Array(String)   song|speech|audiobook|singsong|video
     *    media-type                Array(String)   audio|video
     *    unpublished               String          hide|show|only Role: ROLE_CONTENT_UNPUBLISHED
     *    tags                      Array(String)
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;track/latest&#x27;,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a list of tracks related to what you asked for **/
  factory.trackRel = function(name, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    size                      Integer         \d+ Def = 20
     *    from                      Integer         \d+ Def = 0
     *    content-type              Array(String)   song|speech|audiobook|singsong|video
     *    media-type                Array(String)   audio|video
     *    unpublished               String          hide|show|only Role: ROLE_CONTENT_UNPUBLISHED
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;track/rel/&#x27;+name,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a translated version of a track **/
  factory.trackGet = function(id) {

    /** RETURNS
     *    Absolute file path
     */

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;track/&#x27;+id,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a translated version of a track **/
  factory.trackPut = function(id, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    parent_id *               Integer
     *    listing_parent *          Integer
     *    order *                   Integer
     *    type                      String
     *    description               String
     *    subtype *                 String          speech|audiobook|singsong|video
     *    tags *                    Array(String)
     *    published_at *            datetime        ISO 8601
     *    original_language *       String          ISO 639-1 || ISO 639-3 zxx
     *    translations [{ *         Array(objects)
     *      language: &#x27;&#x27;, *         String          ISO 639-1 || ISO 639-3 zxx
     *      title: &#x27;&#x27;, *            String
     *      rel [{ *                Array(objects)
     *        type: &#x27;&#x27;, *           String          bible|composer|lyrics|interpret|songbook
     *        id: int, *            Integer         type: songbook
     *        name: &#x27;&#x27;,             String          type: composer|lyrics|interpret|songbook
     *        timestamp: int, *     Integer         type: bible|songbook
     *        book: &#x27;&#x27;,             String          type: bible
     *        chapter: int, *       Integer         type: bible
     *        verse: int, *         Integer         type: bible
     *      }],
     *      media [{ *              Array(Objects)
     *        type: &#x27;&#x27;,             String          audio|video
     *        files: [{ *
     *          mime_type: &#x27;&#x27;, *    String
     *          length: int, *      Integer
     *          size: int, *        Integer
     *          path: &#x27;&#x27; *          String
     *        }],
     *      }],
     *    }]
     *    rel[{
     *      type: &#x27;&#x27;, *             String
     *      id: int, *              Integer         type: songbook
     *      name: &#x27;&#x27;,               String          type: composer|lyrics|interpret|songbook
     *      timestamp: int, *       Integer         type: bible|songbook
     *      book: &#x27;&#x27;,               String          type: bible
     *      chapter: int, *         Integer         type: bible
     *      verse: int, *           Integer         type: bible
     *    }]
     */

    return $.ajax({
      method: &#x27;PUT&#x27;,
      url: serverUrl+&#x27;track/&#x27;+id,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a translated version of a track **/
  factory.trackDelete = function(id) {

    return $.ajax({
      method: &#x27;DELETE&#x27;,
      url: serverUrl+&#x27;track/&#x27;+id,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a translated version of a track **/
  factory.trackFiles = function(id, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    type *                    String          audio|video
     *    file *                    file
     */

    return $.ajax({
      method: &#x27;POST&#x27;,
      url: serverUrl+&#x27;track/&#x27;+id+&#x27;/files&#x27;,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Get a file you can play **//* | Doesnt require a function
  factory.trackFetch = function(absPath) {

    /** OPTIONS (Stars = Required)
     *    absPath: *               serverUrl/track/{id}/{lang}/track.{format}
     *    {id}: *                  Integer
     *    {lang}: *                String          ISO 639-1 || ISO 639-3
     *    {format}: *              String          mp3|opus|mp4
     *//*

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: absPath
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };*/

  /** Get the users profile **/
  factory.user = function() {

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;user&#x27;,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Add a track, and PUT it again **/
  factory.userTrackCollectionLink = function(playlist, tracks) {

    if (typeof tracks === &#x27;undefined&#x27;) { tracks = {}; }

    /** headers
     *    &#x27;Accept-Language&#x27;:        String          ISO 639-1 || ISO 639-3
     *    &#x27;Link&#x27;:                   &lt;url1&gt; &lt;- Currently not working with multiple
     *    &#x27;Link&#x27;:                   &lt;url2&gt; &lt;- last will be used
     */

    return $.ajax({
      method: &#x27;LINK&#x27;,
      url: serverUrl+&#x27;user/track_collection/&#x27;+playlist,
      beforeSend: function (xhr) {
        $.each(tracks, function() {
          //@todo - Find a solution for multiple Link requests
          xhr.setRequestHeader(&#x27;Link&#x27;, &#x27;&lt;&#x27;+serverUrl+&#x27;track/&#x27;+this+&#x27;&gt;&#x27;);
        });
      },
      dataType: &#x27;json&#x27;
    }).fail( function() {

      //console.log(xhr);

    });

  };

  /** Get a collection **/
  factory.userTrackCollectionGet = function(id) {

    return $.ajax({
      method: &#x27;GET&#x27;,
      url: serverUrl+&#x27;user/track_collection/&#x27;+id,
      dataType: &#x27;json&#x27;
    }).fail( function(xhr) {

      console.log(xhr);

    });

  };

  /** Add to collection **/
  factory.userTrackCollectionPut = function(id, options) {

    if (typeof options === &#x27;undefined&#x27;) { options = {}; }

    /** OPTIONS (Stars = Required)
     *    type                      String          Always &#x27;track_collection&#x27;
     *    track_references [{ *
     *      id: int, *              Integer
     *      language: &#x27;&#x27;, *         String          ISO 639-1 || ISO 639-3
     *    }]
     */

    options.type = &#x27;track_collection&#x27;;

    return $.ajax({
      method: &#x27;PUT&#x27;,
      url: serverUrl+&#x27;user/track_collection/&#x27;+id,
      data: $.param(options),
      dataType: &#x27;json&#x27;
    }).fail( function() {

      //console.log(xhr);

    });

  };

  /** Delete a collection **/
  factory.userTrackCollectionDelete = function(id) {

    return $.ajax({
      method: &#x27;DELETE&#x27;,
      url: serverUrl+&#x27;user/track_collection/&#x27;+id,
      dataType: &#x27;json&#x27;
    }).fail( function() {

      //console.log(xhr);

    });

  };

  return factory;

}]);
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
